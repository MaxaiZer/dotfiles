steps:
  - id: install-goland-linux
    os: "linux"
    script: | #2024 version to easy crack
      set -euo pipefail
      ARCHIVE=goland-2024.2.3.tar.gz
      wget -c --progress=bar:force -O $ARCHIVE "https://download-cdn.jetbrains.com/go/goland-2024.2.3.tar.gz"
      EXTRACTED_NAME=$(tar -tf "${ARCHIVE}" | head -n1 | cut -d'/' -f1)
      if [ -z "${EXTRACTED_NAME}" ]; then
        echo "Failed to determine extracted directory name from ${ARCHIVE}" >&2
        exit 1
      fi
      sudo tar -xzf "${ARCHIVE}" -C /opt/jetbrains
      sudo ln -sfn /opt/jetbrains/$EXTRACTED_NAME /opt/jetbrains/goland
      rm -f "${ARCHIVE}"

      DESKTOP_FILE="$HOME/.local/share/applications/goland.desktop"
      mkdir -p "$(dirname "$DESKTOP_FILE")"
      cat > "$DESKTOP_FILE" <<'EOL'
      [Desktop Entry]
      Version=1.0
      Type=Application
      Name=Goland
      Exec=/opt/jetbrains/goland/bin/goland.sh
      Icon=/opt/jetbrains/goland/bin/goland.png
      Categories=Development;IDE;
      Terminal=false
      EOL
